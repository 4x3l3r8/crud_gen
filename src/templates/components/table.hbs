{{!-- Table Component Generator (TanStack React Table) --}}
import { useMemo, useState } from 'react';
import { createColumnHelper } from '@tanstack/react-table';
import { Button, HStack, IconButton, Portal } from '@chakra-ui/react';
import { useNavigate } from 'react-router-dom';
import { DataTable } from '@/components/ui/DataTable';
import { LuMoreVertical } from 'react-icons/lu';
import type { {{pascalCase entity}} } from '@/types/{{camelCase entity}}';
import { useGet{{plural}}Query, useDelete{{pascalCase entity}}Mutation } from '@/store/{{camelCase
entity}}/{{camelCase entity}}Api';
{{#if mutationUIisModal}}
import { Edit{{pascalCase entity}}Modal } from './Edit{{pascalCase entity}}Modal';
import { Delete{{pascalCase entity}}Modal } from './Delete{{pascalCase entity}}Modal';
{{/if}}
{{#if mutationUIisDrawer}}
import { Edit{{pascalCase entity}}Drawer } from './Edit{{pascalCase entity}}Drawer';
import { Delete{{pascalCase entity}}Drawer } from './Delete{{pascalCase entity}}Drawer';
{{/if}}

const columnHelper = createColumnHelper<{{pascalCase entity}}>();

    export const {{pascalCase entity}}Table = () => {
    const navigate = useNavigate();
    const [page, setPage] = useState(1);
    const {useList, goToEdit, goToDetails} = use{{pascalCase entity}}();

    const { data, isLoading, isFetching } = useList({
    page,
    limit: {{pagination.defaultPageSize}},
    });
    const [deleteId, setDeleteId] = useState<string | null>(null);
        const [openDeleteModal, setOpenDeleteModal] = useState(false);
        const [editId, setEditId] = useState<string | null>(null);
            const [openEditModal, setOpenEditModal] = useState(false);
            const [viewId, setViewId] = useState<string | null>(null);
                const [openViewModal, setOpenViewModal] = useState(false);

                const setEdit = (id: string) => {
                {{#if mutationUIisModal}}
                setEditId(id)
                setOpenEditModal(true)
                {{/if}}
                {{#if mutationUIisPage}}
                goToEdit(id)
                {{/if}}
                }

                const setView = (id: string) => {
                {{#if mutationUIisModal}}
                setViewId(id)
                setOpenViewModal(true)
                {{/if}}
                {{#if mutationUIisPage}}
                goToDetails(id)
                {{/if}}
                }

                const Menu = (id: string) => {
                return (
                <Menu.Root>
                    <Menu.Trigger asChild>
                        <IconButton aria-label="Table Actions" variant="surface">
                            <LuMoreVertical />
                        </IconButton>
                    </Menu.Trigger>
                    <Portal>
                        <Menu.Positioner>
                            <Menu.Content>
                                {{#if views.details}}
                                <Menu.Item value="view" onClick={()=> setView(id)}>
                                    View
                                </Menu.Item>
                                {{/if}}

                                <Menu.Item value="edit" onClick={()=> setEdit(id)}>
                                    Edit
                                </Menu.Item>
                                <Menu.Separator />
                                <Menu.Item value="delete" onClick={()=> setDeleteId(id)}>
                                    Delete
                                </Menu.Item>
                            </Menu.Content>
                        </Menu.Positioner>
                    </Portal>
                </Menu.Root>
                )
                }

                const columns = useMemo(
                () => [
                {{#each tableFields}}
                columnHelper.accessor('{{name}}', {
                header: '{{#if ui.table.header}}{{ui.table.header}}{{else}}{{name}}{{/if}}',
                cell: (info) => info.getValue(),
                {{#unless ui.table.sortable}}
                enableSorting: true,
                {{/unless}}
                }),
                {{/each}}
                columnHelper.accessor('id',{
                id: 'actions',
                header: 'Actions',
                cell: ({ row }) => (
                <Menu id={row.original.id} />
                ),
                }),
                ],
                []
                );

                return (
                <>
                    <DataTable columns={columns} data={data?.data || []} isLoading={isLoading || isFetching}
                        pagination={ { page, limit: {{pagination.defaultPageSize}}, total: data?.meta?.total || 0,
                        onPageChange: setPage, } } />

                    {{#ifeq views.details.type 'modal'}}
                    <View{{pascalCase entity}}Modal open={openViewModal} setOpen={setOpenViewModal} id={viewId} />
                    {{/ifeq}}

                    {{!-- render the drawer if the mutationUIisDrawer is true --}}
                    {{#ifeq mutationUIisDrawer true}}
                    <Edit{{pascalCase entity}}Drawer open={openEditModal} setOpen={setOpenEditModal} id={editId} />
                    {{/ifeq}}

                    {{!-- render the modal if the mutationUIisModal is true --}}
                    {{#ifeq mutationUIisModal true}}
                    <Edit{{pascalCase entity}}Modal open={openEditModal} setOpen={setOpenEditModal} id={editId} />
                    {{/ifeq}}

                    <Delete{{pascalCase entity}}Modal open={openDeleteModal} setOpen={setOpenDeleteModal}
                        id={deleteId} />
                </>
                );
                };